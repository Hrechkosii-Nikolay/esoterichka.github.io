AddType application/manifest+json .webmanifest

# ==============================
# üåê –û—Å–Ω–æ–≤–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∞–π—Ç—É
# ==============================

AddDefaultCharset UTF-8
Options -Indexes
RewriteEngine On

# ------------------------------
# üîÅ –†–µ–¥–∏—Ä–µ–∫—Ç–∏ –¥–ª—è SEO
# ------------------------------

# –ü—Ä–∏–º—É—Å–æ–≤–∏–π HTTPS + –≤–∏–¥–∞–ª–µ–Ω–Ω—è www
RewriteCond %{HTTPS} !=on [OR]
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteRule ^(.*)$ https://esoterichka.com.ua/$1 [L,R=301]

# index.html ‚Üí /
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s/index\.html [NC]
RewriteRule ^index\.html$ https://esoterichka.com.ua/ [R=301,L]

# ------------------------------
# üß≠ Canonical (–¥—É–±–ª—ñ–∫–∞—Ç–∏ –±–µ–∑ /)
# ------------------------------

# –í–∏–¥–∞–ª—è—î–º–æ –∫—ñ–Ω—Ü–µ–≤–∏–π —Å–ª–µ—à –∑ URL, —è–∫—â–æ —Ü–µ –Ω–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} (.+)/$
RewriteRule ^ %1 [R=301,L]

# ------------------------------
# üöÄ –ö–µ—à—É–≤–∞–Ω–Ω—è —Ç–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å
# ------------------------------

<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 1 month"
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType text/css "access plus 1 year"
  ExpiresByType application/javascript "access plus 1 year"
  ExpiresByType font/woff "access plus 1 year"
  ExpiresByType font/woff2 "access plus 1 year"
</IfModule>

<IfModule mod_headers.c>
  <FilesMatch "\.(js|css|jpg|jpeg|png|gif|svg|webp|woff|woff2)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>
</IfModule>

# ------------------------------
# ü™∂ –ö–æ–º–ø—Ä–µ—Å—ñ—è (GZIP / Brotli)
# ------------------------------

<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css
  AddOutputFilterByType DEFLATE application/javascript application/json application/xml
  AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>

<IfModule mod_brotli.c>
  BrotliCompressionQuality 5
</IfModule>

# ------------------------------
# üîí –ë–µ–∑–ø–µ–∫–∞
# ------------------------------

<IfModule mod_headers.c>
  # üö´ –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è iframe –∑ —ñ–Ω—à–∏—Ö —Å–∞–π—Ç—ñ–≤
  Header always set X-Frame-Options "SAMEORIGIN"

  # üß± –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø—ñ–¥–º—ñ–Ω–∏ MIME-—Ç–∏–ø—ñ–≤
  Header always set X-Content-Type-Options "nosniff"

  # üß© –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ XSS-–∞—Ç–∞–∫
  Header always set X-XSS-Protection "1; mode=block"

  # üîç –ü–æ–ª—ñ—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–µ—Ä–∞
  Header always set Referrer-Policy "strict-origin-when-cross-origin"

  # ‚öôÔ∏è –î–æ–∑–≤–æ–ª–∏ –¥–ª—è API –±—Ä–∞—É–∑–µ—Ä–∞
  Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"

  # üåê –ü–æ–ª—ñ—Ç–∏–∫–∞ –±–µ–∑–ø–µ–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É (CSP) ‚Äî –û–î–ò–ù –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∑ –ø–æ–≤–Ω–∏–º –¥–æ–∑–≤–æ–ª–æ–º –¥–ª—è Google Maps
  Header always set Content-Security-Policy "default-src 'self'; frame-src 'self' https://www.google.com https://www.google.com.ua https://www.gstatic.com https://maps.google.com; script-src 'self' https://www.google.com https://www.gstatic.com https://maps.googleapis.com; img-src 'self' data: https://www.google.com https://maps.gstatic.com https://lh3.googleusercontent.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com;"
</IfModule>

# ------------------------------
# üö´ –ó–∞–±–æ—Ä–æ–Ω–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ —Å–∏—Å—Ç–µ–º–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
# ------------------------------

<FilesMatch "(\.(htaccess|htpasswd|ini|log|sh|bak|env))$">
  Order Allow,Deny
  Deny from all
</FilesMatch>

# ------------------------------
# üì® PHP-—Ñ–∞–π–ª–∏
# ------------------------------

<Files "telegram.php">
  Require all granted
</Files>

# ------------------------------
# ü™Ñ MIME —Ç–∏–ø–∏
# ------------------------------

AddType image/avif .avif
AddType image/webp .webp
AddType font/woff2 .woff2
AddType font/woff .woff
AddType application/javascript .js
AddType text/css .css

# ------------------------------
# ‚ö†Ô∏è –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
# ------------------------------

ErrorDocument 404 /index.html
ErrorDocument 403 /index.html
ErrorDocument 500 /index.html

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^.*$ /index.html [L,R=302]

# ------------------------------
# üåç SEO: Sitemap + Robots
# ------------------------------

<IfModule mod_rewrite.c>
  RewriteCond %{REQUEST_URI} ^/sitemap\.xml$ [NC]
  RewriteRule ^ - [L]
</IfModule>

# ‚úÖ –ö—ñ–Ω–µ—Ü—å –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
